<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Services | Panel Admin</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body class="panel">

  <h2>Services (Produits)</h2>

  <form id="addServiceForm">
    <input name="name" placeholder="Nom du service" required>
    <input name="price" placeholder="Prix (GDS)" required type="number">
    <button type="submit">Ajouter</button>
  </form>

  <div id="servicesList"></div>

  <script>
    const API_URL = "https://e-s-service-backend.onrender.com";

    function loadServices() {
      fetch(`${API_URL}/admin/services`)
        .then(res => res.json())
        .then(data => {
          const box = document.getElementById("servicesList");
          box.innerHTML = "";

          data.forEach(s => {
            box.innerHTML += `
              <div class="card">
                <strong>${s.name}</strong>
                <p>${s.price} GDS</p>
              </div>
            `;
          });
        });
    }

    document.getElementById("addServiceForm").onsubmit = async (e) => {
      e.preventDefault();
      const form = Object.fromEntries(new FormData(e.target));

      await fetch(`${API_URL}/admin/services`, {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify(form)
      });

      e.target.reset();
      loadServices();
    };

    loadServices();
  </script>

</body>
</html>
